# 51 Defi基础

> blockchain最重要的应用就是defi，没有之一

# Token概念

- #### 资产即token

  - 智能合约可以创建不被别人剥夺的资产，而token就是资产的象征
  - ERC20、ERC712让资产发行、管理、交易变得简单

- #### 术语

  - TGE：Token Generation Event，发行代币
  - ITO：Initial Token Offering，首次功能型token发行
  - STO：Security Token Offering，证券型token发行
  - ICO：Initial Coin Offering，首次项目方像投资者募资
  - IDO：Initial DEX Offering，首次dex发行代币
  - IEO：Initial Exchange Offering，首次交易所发行代币

- #### 经济模型（tokenomics）

  - 经济模型是除了团队外最重要的**项目成败**影响因素
  - 三个重要的考量
    - 捕获：怎么捕获价值（商业模型），或者不捕获价值（纯炒作meme，uni）
    - 分享：如何分享价值（怎么激励、是否公平）
    - 释放：如何锁仓？是否增发？通缩还是通胀模型
  - 好的经济模型让项目形成正向飞轮

- #### 类别

  - 实用型，持有了才能使用服务
    - Link，Eth等提供技术服务，
    - usdt稳定币，提供支付功能，并绑定外界的美元
  - 权益型/证券型，代表资产主权，持有了才能投票、治理、分红，属于承诺会增长的资产
    - stETH（拼好押）、LPToken、UNI（投票）、RWA
    - 这种事最容易违规的，常因为承诺收益被认定为股票，比如XRP

- #### 分配

  - 一般来说社区和用户占绝大多数，因为用户创造的价值
  - 用户获取的三种方式
    - 空投
    - 挖矿
    - 私募IDO，一般不对普通人开放

# Token发行

### IDO-LaunchPad

#### 示例：

1. 一个新的区块链项目要发币，比如“元宇宙猫币”。
2. 它找一个 Launchpad，比如 Binance Launchpad 或者 PinkSale。
3. Launchpad 会宣传、安排流程，比如时间、认购价格、人数上限。
4. 到点后，用户可以抢先用 USDT 或 ETH 买这个新币，这个过程就叫做 IDO。

所以：

- Launchpad 是舞台
- IDO 是首场演出

#### 去中心化的LaunchPad

- https://polkastarter.com/
-  https://www.pump.fun/

#### 交易所的LaunchPad

- 币安

### 私募-锁仓

- 私募投资人和团队成员，通常持有较多的token，为了避免抛压，会有锁仓机制
- 锁仓方式
  - 线性释放：每月解锁1/24，一共两年
  - 周期释放：每季度或者每半年释放一次
  - 参与型：根据任务，指标释放，比如作为社区奖励
- 有一些项目会有Cliff（悬崖期）
  - 就像站在悬崖钱你却不会掉下去，保证比如说一年时间内所有的代币都会能认领，一年之后才能每月释放
  - 但是其他的那些散户，比如拿了空投的人，到手了就可以直接卖，肯定是比私募投资和团队成员的人更早能卖的

# 质押、流动性挖矿

sushi的所有token都是流动性提供者在赚取手续费的时候，顺便mint出来的，比如uniswap是奖励你提供的两种代币每笔交易的0.3%，而sushi是每笔交易的0.2%+0.1%当前计价得到的sushi币。

### 🍱 故事背景：

你住在一个社区，社区里有一家新的寿司餐厅，叫做 SushiSwap 寿司店。

##### 🍣 一、什么是 Staking（质押）？

你很看好这家寿司店，就像看好一个平台的未来发展。于是你说：

> “我不光来吃，我还愿意投点钱入股这家店，让你把我的钱拿去升级装修、进货、做活动。”

这时，餐厅老板说：

> “那我每个月就从我们餐厅赚的钱里，给你一点分红。你投得越多，分红越多。”

这就像你质押了 SUSHI 代币（入股餐厅），每个月拿到分红（交易手续费 or 新的 SUSHI 奖励）。

📌 类比总结：

质押 = 投资餐厅股份，等它赚钱分红。你投的是餐厅自己的股票（SUSHI）。

##### 💧 二、什么是 Liquidity Mining（流动性挖矿）？

现在餐厅要搞一个“预付卡换菜品”的计划。比如：

- 顾客可以用 “ETH” 和 “USDT” 来买菜
- 但餐厅需要有人提前拿出 ETH + USDT，放在“点餐池子”里，才能让顾客来兑换和交易。

这时你说：

> “我愿意提供 ETH + USDT 放进点餐池，让你餐厅用。”

老板说：

> “谢谢你！你帮我方便了点餐流程，那我就把每一笔点餐收的手续费，分一部分给你。”

> 如果是 Sushi 店，老板还说：“另外再奖励你点 Sushi 代币，谢谢支持！”

📌 类比总结：

流动性挖矿 = 你像餐厅提前提供了兑换用的货币池，赚的是手续费，可能还有平台发的额外奖励（SUSHI）。

# DEX去中心化交易所

> 去中心化的交易所，始终掌握自己的资产，互操作性好

### Amm

自动做市商，通过一定的数学公式，保证资产兑换得以完成

### uniswap Amm原理

- 常量乘积模型：K = x * y
  - 没有价格与演技
  - x：token0的储备量
  - y：token1的储备量
  - 流动性
    - 需要外部转入token0，token1，以增加储备量reserve0，reserver1，拿到流动性凭证LP token，数量为当时的你提供的x和y的乘积的根号
  - 兑换时
    - reserver0减少，就会增加reserver1
    - reserver1减少，就会增加reserver0

# Uniswap流动性挖矿

#### 🧪 设定一个 Uniswap 池子：

这是一个 **ETH/USDT** 的池子：

池子里有：

- 🟣 100 ETH
- 🟢 300,000 USDT

（假设此时 ETH 价格是 1 ETH = 3,000 USDT，没问题对吧）

> 所以这个池子是按 **1 ETH : 3,000 USDT** 来做市的。

------

### 🧍你想加入池子，提供流动性

你想放入：

- 🟣 1 ETH
- 🟢 3,000 USDT

是不是刚好和池子的比例一样？是的！

------

#### 那你能获得多少 LP Token 呢？

假设这个池子总共已经发了 1,000 个 LP Token（早期用户加进去的），你提供的资金占整个池子的比例是：

> 你的 ETH 占比 = 1 / 100 = 1%
>  你的 USDT 占比 = 3,000 / 300,000 = 1%

✅ 所以你占整个池子的 **1%**

➡️ 你就可以获得 **1% × 1,000 = 10 个 LP Token**

------

### 🧠 再补一句重点：

如果你不是按照正确的比例（1 ETH : 3,000 USDT）去提供，比如你只放了 1 ETH，却只放了 1,000 USDT，那系统会帮你退回多余的 ETH，或者告诉你“不行，请补足 USDT”。

------

# Uniswap兑换

#### 🌊 初始状态（ETH/USDT 池子）

- 🟣 ETH 数量：100
- 🟢 USDT 数量：300,000
- 初始池子乘积：100 × 300,000 = 30,000,000
- 假设 Uniswap 的手续费是 0.3%

------

#### 🎯 有人拿 1,500 USDT 来换 ETH，会发生什么？

##### 第 1 步：收手续费

- 他想用 **1,500 USDT**
- 先扣手续费 0.3%：
   ➡️ 手续费 = 1,500 × 0.003 = 4.5 USDT
   ➡️ 实际进池子的是：**1,495.5 USDT**

------

##### 第 2 步：用乘积不变公式求出能换多少 ETH

这个人把 1,495.5 USDT 放进去了，那么池子里的 USDT 变成：

> 300,000 + 1,495.5 = 301,495.5

我们用公式：

> 新 ETH 数量 × 新 USDT 数量 = 原乘积 = 30,000,000

设新 ETH 数量为 `x`，我们有：

> x × 301,495.5 = 30,000,000
>  x ≈ 99.5039 ETH

所以池子剩下约 99.5039 个 ETH，换句话说，这个人拿走了：

> 100 - 99.5039 = **0.4961 ETH**

------

##### ✅ 最后状态

- 🟣 ETH 数量 ≈ 99.5039
- 🟢 USDT 数量 = 301,495.5
- 用户得到了 ≈ 0.4961 ETH
- 手续费：4.5 USDT，归 LP（流动性提供者）所有
- 滑点为：1  -（0.4961/0.5）≈  8%

> [!note] 
>
> 滑点就是目标代币的期望的所得量与实际所得量的偏差